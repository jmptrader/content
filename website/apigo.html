<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<title>PubSubSQL - Go Client API</title>
<meta http-equiv="Content-Type" content="text/html; iso-8859-1" />
<link href="style.css" type="text/css" rel="stylesheet" />
        <script>
            (function (i, s, o, g, r, a, m) {
                i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
                    (i[r].q = i[r].q || []).push(arguments)
                }, i[r].l = 1 * new Date(); a = s.createElement(o),
                m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
            })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

            ga('create', 'UA-48120758-1', 'pubsubsql.com');
            ga('send', 'pageview');

</script>
<!-- Google Code for Remarketing tag -->
<!-- Remarketing tags may not be associated with personally identifiable information or placed on pages related to sensitive categories. For instructions on adding this tag and more information on the above requirements, read the setup guide: google.com/ads/remarketingsetup -->
<script type="text/javascript">
/* <![CDATA[ */
var google_conversion_id = 984295711;
var google_conversion_label = "e3V2CMmfggUQn9Ks1QM";
var google_custom_params = window.google_tag_params;
var google_remarketing_only = true;
/* ]]> */
</script>
<script type="text/javascript" src="//www.googleadservices.com/pagead/conversion.js">
</script>
<noscript>
<div style="display:inline;">
<img height="1" width="1" style="border-style:none;" alt="" src="//googleads.g.doubleclick.net/pagead/viewthroughconversion/984295711/?value=0&amp;label=e3V2CMmfggUQn9Ks1QM&amp;guid=ON&amp;script=0"/>
</div>
</noscript>

</head>

<body>
<div id="container">
	<div id="header">
		<div id="logo"><a href="index.html"><img src="images/logo.gif" border="0" alt="Logo" /></a></div>
		<div id="slogan">An open-source in-memory database integrated with Publish-Subscribe - Ver. 1.0.0 </div>
		<div id="social">
			<a target="_blank" href="http://groups.google.com/group/pubsubsql"><img src="images/ggroups.png" border="0" alt="Git" /></a>			
			<a target="_blank" href="https://twitter.com/PubSubSQL"><img src="images/twitter.png" border="0" alt="Twitter" /></a>
			<a target="_blank" href="http://www.youtube.com/PubSubSQL"><img src="images/youtube.png" border="0" alt="youtube" /></a>
			<a target="_blank" href="https://github.com/pubsubsql"><img src="images/git.png" border="0" alt="Git" /></a>			
		 </div>
	</div>
	<div id="hmenu">
		<ul id="main-menu">
			<li class="first"><a href="download.html">Download</a>
            </li>
            <li><a href="#">How To</a>
				<ul class="drop-down">
					<li><a href="runlinux.html">run on Linux</a></li>
					<li><a href="runwindows.html">run on Windows</a></li>
				</ul>
			</li>
			<li><a href="#">API</a>
				<ul class="drop-down">
					<li><a href="apigo.html">Go</a></li>
					<li><a href="apijava.html">Java</a></li>
					<li><a href="apidotnet.html">.Net</a></li>
				</ul>
			</li>
			<li><a href="sql.html">SQL</a>
				<ul class="drop-down">
					<li><a href="sql.html">SQL must-know rules</a></li>
					<li><a href="sql.html#subscribe">subscribe</a></li>
					<li><a href="sql.html#skip ">subscribe skip</a></li>
					<li><a href="sql.html#unsubscribe">unsubscribe</a></li>
					<li><a href="sql.html#key">key</a></li>
					<li><a href="sql.html#tag">tag</a></li>
				</ul>
			</li>
			<li class="last-child"><a href="#">More</a>
				<ul class= "drop-down">
					<li><a href="license.html">License</a></li>
					<li><a href="community.html">Community</a></li>
				</ul>
			</li>
		</ul>
	</div>		
	<div id="containter-content">
	<div id="inner-content">
		<br/>
		<pre>Please ask us a question: email <a href="mailto:oleg@pubsubsql.com">oleg@pubsubsql.com</a> twitter <a href="https://twitter.com/PubSubSQL">@PubSubSQL</a> forum <a href="http://groups.google.com/group/pubsubsql">groups.google.com/group/pubsubsql</a> </pre>

		<h1>Go Client API</h1>

<pre>package main

import (
    "github.com/pubsubsql/client"
    "fmt"
)

func main() {
    client := new(pubsubsql.Client)
    if client.Connect("localhost:7777") {
        fmt.Printf("Hello PubSubSQL")
    }
} </pre>

		<p>PubSubSQL provides a unified client API with the same look and feel for all supported languages.</p>

		<h3><a href="#install">Install</a></h3>
		<h3><a href="#link_client">Client type reference</a></h3>	
		<h3><a href="#link_quick_start">Quick Start example</a></h3>
		
		<hr/>
		
		<h5 id="install" class="blue_title">Install</h5>
		<p>In order to use the Go Client API, you must first configure it in your Go workspace using the "go get" command. 
           The GOPATH environment variable specifies the location of your workspace.
		</p>
        <pre>$ go get github.com/pubsubsql/client
$ go get github.com/pubsubsql/samples
        </pre>
        <p>As an alternative, you may copy the Go Client API sources manually. 
        The sources are part of the downloaded distribution and are located in a directory called DOWNLOAD_DIR/pubsubsql/samples/go/src .</p>
		
		
		<h5 id="link_client" class="blue_title">Client type reference</h5>
		<p>Client is a type that provides an interface to the PubSubSQL server. It can be used to send commands to and receive pubsub notifications from the server.</p>
		<dl>
			<dt><a href="#Client">type Client</a></dt>
			<dd><a href="#Client.Connect">func (this *Client) Connect(address string) bool</a></dd>
			<dd><a href="#Client.Disconnect">func (this *Client) Disconnect()</a></dd>
			<dd><a href="#Client.Connected">func (this *Client) Connected() bool</a></dd>
			<dd><a href="#Client.Ok">func (this *Client) Ok() bool</a></dd>
			<dd><a href="#Client.Failed">func (this *Client) Failed() bool</a></dd>
			<dd><a href="#Client.Error">func (this *Client) Error() string</a></dd>
			<dd><a href="#Client.Execute">func (this *Client) Execute(command string) bool</a></dd>
			<dd><a href="#Client.JSON">func (this *Client) JSON() string</a></dd>
			<dd><a href="#Client.Action">func (this *Client) Action() string</a></dd>
			<dd><a href="#Client.PubSubId">func (this *Client) PubSubId() string</a></dd>
			<dd><a href="#Client.RowCount">func (this *Client) RowCount()</a></dd>
			<dd><a href="#Client.NextRow">func (this *Client) NextRow() bool</a></dd>
			<dd><a href="#Client.Value">func (this *Client) Value(column string) string</a></dd>
			<dd><a href="#Client.ValueByOrdinal">func (this *Client) ValueByOrdinal(ordinal int) string</a></dd>
			<dd><a href="#Client.HasColumn">func (this *Client) HasColumn(column string) bool</a></dd>
			<dd><a href="#Client.ColumnCount">func (this *Client) ColumnCount() int</a></dd>
			<dd><a href="#Client.Columns">func (this *Client) Columns() []string</a></dd>
			<dd><a href="#Client.WaitForPubSub">func (this *Client) WaitForPubSub(timeout int) bool</a></dd>
		</dl>
		
		<pre id="Client.Connect">func (this *Client) Connect(address string) bool</pre>
		<p>Connect connects the Client to the pubsubsql server. Address string has the form host:port.</p>

		<pre id="Client.Disconnect">func (this *Client) Disconnect()</pre>
		<p>Disconnect disconnects the Client from the pubsubsql server.</p>

		<pre id="Client.Connected">func (this *Client) Connected() bool</pre>
		<p>Connected returns true if the Client is currently connected to the pubsubsql server.</p>

		<pre id="Client.Ok">func (this *Client) Ok() bool</pre>
		<p>Ok determines if the last command executed against the pubsubsql server succeeded.</p>

		<pre id="Client.Failed">func (this *Client) Failed() bool</pre>
		<p>Failed determines if the last command executed against the pubsubsql server failed. </p>

		<pre id="Client.Error">func (this *Client) Error() string</pre>
		<p>Error returns an error message when the last command executed against the pubsubsql server fails.</p>
		<p>Functions that may generate an error are [Connect, Execute, NextRow, WaitForPubSub].</p>

		<pre id="Client.Execute">func (this *Client) Execute(command string) bool</pre>
		<p>Execute executes a command against the pubsubsql server and returns true on success.</p>
		<p>The pubsubsql server returns to the Client a response in JSON format.</p>

		<pre id="Client.JSON">func (this *Client) JSON() string</pre>
		<p>JSON returns a response string in JSON format from the last command executed against 
		the pubsubsql server.</p>

		<pre id="Client.Action">func (this *Client) Action() string</pre>
		<p>Action returns an action string from the response returned by the last command executed 
		against the pubsubsql server.</p>
		<p>Valid actions are [status, insert, select, delete, update, add, remove, subscribe, unsubscribe].</p>

		<pre id="Client.PubSubId">func (this *Client) PubSubId() string</pre>
		<p>PubSubId returns a unique identifier generated by the pubsubsql server when 
		a Client subscribes to a table. If the client has subscribed to more than  one table,</p>
		<p>PubSubId should be used by the Client to uniquely identify messages 
		published by the pubsubsql server.</p>

		<pre id="Client.RowCount">func (this *Client) RowCount() int</pre>
		<p>RowCount returns the number of rows in the result set returned by the pubsubsql server.</p>

		<pre id="Client.NextRow">func (this *Client) NextRow() bool</pre>
		<p>NextRow is used to move to the next row in the result set returned by the pubsubsql server. 
		When called for the first time, NextRow moves to the first row in the result set.</p>
		<p>Returns false when all rows are read or if there is an error.
		To find out if false was returned because of an error, use Ok or Failed functions. </p>

		<pre id="Client.Value">func (this *Client) Value(column string) string</pre>
		<p>Value returns the value within the current row for the given column name.</p>
		<p>If the column name does not exist, Value returns an empty string.</p>

		<pre id="Client.ValueByOrdinal">func (this *Client) ValueByOrdinal(ordinal int) string</pre>
		<p>ValueByOrdinal returns the value within the current row for the given column ordinal.
		The column ordinal represents the zero based position of the column in the Columns 
		collection of the result set.</p>
		<p>If the column ordinal is out of range, ValueByOrdinal returns an empty string.</p>

		<pre id="Client.HasColumn" >func (this *Client) HasColumn(column string) bool</pre>
		<p>HasColumn determines if the column name exists in the columns collection of the result set.</p>

		<pre id="Client.ColumnCount">func (this *Client) ColumnCount() int</pre>
		<p>ColumnCount returns the number of columns in the columns collection of the result set.</p>

		<pre id="Client.Columns">func (this *Client) Columns() []string</pre>
		<p>Columns returns the column names in the columns collection of the result set.</p>

		<pre id="Client.WaitForPubSub">func (this *Client) WaitForPubSub(timeout int) bool</pre>
		<p>WaitForPubSub waits until the pubsubsql server publishes a message for 
		the subscribed Client or until the timeout interval elapses.</p>
		<p>Returns false when timeout interval elapses or if there is an error.</br>
		To find out if false was returned because of an error, use Ok or Failed functions.</p>		

        <h5 id="link_quick_start" class="blue_title">Quick Start example</h5>

        <!-- HTML generated using hilite.me --><div style="background: #ffffff; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #0000ff">package</span> main

<span style="color: #0000ff">import</span> (
    <span style="color: #a31515">&quot;fmt&quot;</span>
    <span style="color: #a31515">&quot;github.com/pubsubsql/client&quot;</span>
)

<span style="color: #008000">/* MAKE SURE TO RUN PUBSUBSQL SERVER WHEN RUNNING THE EXAMPLE */</span>

<span style="color: #0000ff">func</span> checkError(client *pubsubsql.Client, str <span style="color: #2b91af">string</span>) {
    <span style="color: #0000ff">if</span> client.Failed() {
        fmt.Println(<span style="color: #a31515">&quot;Error:&quot;</span>, client.Error(), str)
    }
}

<span style="color: #0000ff">func</span> main() {
    client := new(pubsubsql.Client)
    subscriber := new(pubsubsql.Client)

    <span style="color: #008000">//----------------------------------------------------------------------------------------------------</span>
    <span style="color: #008000">// CONNECT</span>
    <span style="color: #008000">//----------------------------------------------------------------------------------------------------</span>

    address := <span style="color: #a31515">&quot;localhost:7777&quot;</span>
    client.Connect(address)
    checkError(client, <span style="color: #a31515">&quot;client connect failed&quot;</span>)
    subscriber.Connect(address)
    checkError(client, <span style="color: #a31515">&quot;subscriber connect failed&quot;</span>)

    <span style="color: #008000">//----------------------------------------------------------------------------------------------------</span>
    <span style="color: #008000">// SQL MUST-KNOW RULES</span>
    <span style="color: #008000">//</span>
    <span style="color: #008000">// All commands must be in lower case.</span>
    <span style="color: #008000">//</span>
    <span style="color: #008000">// Identifiers can only begin with alphabetic characters and may contain any alphanumeric characters.</span>
    <span style="color: #008000">//</span>
    <span style="color: #008000">// The only available (but optional) data definition commands are</span>
    <span style="color: #008000">//    key (unique index)      - key table_name column_name</span>
    <span style="color: #008000">//    tag (non-unique index)  - tag table_name column_name</span>
    <span style="color: #008000">//</span>
    <span style="color: #008000">// Tables and columns are auto-created when accessed.</span>
    <span style="color: #008000">//</span>
    <span style="color: #008000">// The underlying data type for all columns is string.</span>
    <span style="color: #008000">// Strings do not have to be enclosed in single quotes as long as they have no special characters.</span>
    <span style="color: #008000">// The special characters are</span>
    <span style="color: #008000">//    , - comma</span>
    <span style="color: #008000">//      - white space characters (space, tab, new line)</span>
    <span style="color: #008000">//    ) - right parenthesis</span>
    <span style="color: #008000">//    &#39; - single quote</span>
    <span style="color: #008000">//----------------------------------------------------------------------------------------------------</span>

    <span style="color: #008000">//----------------------------------------------------------------------------------------------------</span>
    <span style="color: #008000">// INDEX</span>
    <span style="color: #008000">//----------------------------------------------------------------------------------------------------</span>

    client.Execute(<span style="color: #a31515">&quot;key Stocks Ticker&quot;</span>)
    client.Execute(<span style="color: #a31515">&quot;tag Stocks MarketCap&quot;</span>)

    <span style="color: #008000">//----------------------------------------------------------------------------------------------------</span>
    <span style="color: #008000">// SUBSCRIBE</span>
    <span style="color: #008000">//----------------------------------------------------------------------------------------------------</span>

    subscriber.Execute(<span style="color: #a31515">&quot;subscribe * from Stocks where MarketCap = &#39;MEGA CAP&#39;&quot;</span>)
    pubsubid := subscriber.PubSubId()
    fmt.Println(<span style="color: #a31515">&quot;subscribed to Stocks pubsubid:&quot;</span>, pubsubid)
    checkError(subscriber, <span style="color: #a31515">&quot;subscribe failed&quot;</span>)

    <span style="color: #008000">//----------------------------------------------------------------------------------------------------</span>
    <span style="color: #008000">// PUBLISH INSERT</span>
    <span style="color: #008000">//----------------------------------------------------------------------------------------------------</span>

    client.Execute(<span style="color: #a31515">&quot;insert into Stocks (Ticker, Price, MarketCap) values (GOOG, &#39;1,200.22&#39;, &#39;MEGA CAP&#39;)&quot;</span>)
    checkError(client, <span style="color: #a31515">&quot;insert GOOG failed&quot;</span>)
    client.Execute(<span style="color: #a31515">&quot;insert into Stocks (Ticker, Price, MarketCap) values (MSFT, 38,&#39;MEGA CAP&#39;)&quot;</span>)
    checkError(client, <span style="color: #a31515">&quot;insert MSFT failed&quot;</span>)

    <span style="color: #008000">//----------------------------------------------------------------------------------------------------</span>
    <span style="color: #008000">// SELECT</span>
    <span style="color: #008000">//----------------------------------------------------------------------------------------------------</span>

    client.Execute(<span style="color: #a31515">&quot;select id, Ticker from Stocks&quot;</span>)
    checkError(client, <span style="color: #a31515">&quot;select failed&quot;</span>)
    <span style="color: #0000ff">for</span> client.NextRow() {
        fmt.Println(<span style="color: #a31515">&quot;*********************************&quot;</span>)
        fmt.Printf(<span style="color: #a31515">&quot;id:%s Ticker:%s \n&quot;</span>, client.Value(<span style="color: #a31515">&quot;id&quot;</span>), client.Value(<span style="color: #a31515">&quot;Ticker&quot;</span>))
    }
    checkError(client, <span style="color: #a31515">&quot;NextRow failed&quot;</span>)

    <span style="color: #008000">//----------------------------------------------------------------------------------------------------</span>
    <span style="color: #008000">// PROCESS PUBLISHED INSERT</span>
    <span style="color: #008000">//----------------------------------------------------------------------------------------------------</span>

    timeout := 100
    <span style="color: #0000ff">for</span> subscriber.WaitForPubSub(timeout) {
        fmt.Println(<span style="color: #a31515">&quot;*********************************&quot;</span>)
        fmt.Println(<span style="color: #a31515">&quot;Action:&quot;</span>, subscriber.Action())
        <span style="color: #0000ff">for</span> subscriber.NextRow() {
            fmt.Println(<span style="color: #a31515">&quot;New MEGA CAP stock:&quot;</span>, subscriber.Value(<span style="color: #a31515">&quot;Ticker&quot;</span>))
            fmt.Println(<span style="color: #a31515">&quot;Price:&quot;</span>, subscriber.Value(<span style="color: #a31515">&quot;Price&quot;</span>))
        }
        checkError(subscriber, <span style="color: #a31515">&quot;NextRow failed&quot;</span>)
    }
    checkError(subscriber, <span style="color: #a31515">&quot;WaitForPubSub failed&quot;</span>)

    <span style="color: #008000">//----------------------------------------------------------------------------------------------------</span>
    <span style="color: #008000">// PUBLISH UPDATE</span>
    <span style="color: #008000">//----------------------------------------------------------------------------------------------------</span>

    client.Execute(<span style="color: #a31515">&quot;update Stocks set Price = &#39;1,500.00&#39; where Ticker = GOOG&quot;</span>)
    checkError(client, <span style="color: #a31515">&quot;update GOOG failed&quot;</span>)

    <span style="color: #008000">//----------------------------------------------------------------------------------------------------</span>
    <span style="color: #008000">// SERVER WILL NOT PUBLISH INSERT BECAUSE WE ONLY SUBSCRIBED TO &#39;MEGA CAP&#39;</span>
    <span style="color: #008000">//----------------------------------------------------------------------------------------------------</span>

    client.Execute(<span style="color: #a31515">&quot;insert into Stocks (Ticker, Price, MarketCap) values (IBM, 168, &#39;LARGE CAP&#39;)&quot;</span>)
    checkError(client, <span style="color: #a31515">&quot;insert IBM failed&quot;</span>)

    <span style="color: #008000">//----------------------------------------------------------------------------------------------------</span>
    <span style="color: #008000">// PUBLISH ADD</span>
    <span style="color: #008000">//----------------------------------------------------------------------------------------------------</span>

    client.Execute(<span style="color: #a31515">&quot;update Stocks set Price = 230.45, MarketCap = &#39;MEGA CAP&#39; where Ticker = IBM&quot;</span>)
    checkError(client, <span style="color: #a31515">&quot;update IBM to MEGA CAP failed&quot;</span>)

    <span style="color: #008000">//----------------------------------------------------------------------------------------------------</span>
    <span style="color: #008000">// PUBLISH REMOVE</span>
    <span style="color: #008000">//----------------------------------------------------------------------------------------------------</span>

    client.Execute(<span style="color: #a31515">&quot;update Stocks set Price = 170, MarketCap = &#39;LARGE CAP&#39; where Ticker = IBM&quot;</span>)
    checkError(client, <span style="color: #a31515">&quot;update IBM to LARGE CAP failed&quot;</span>)

    <span style="color: #008000">//----------------------------------------------------------------------------------------------------</span>
    <span style="color: #008000">// PUBLISH DELETE</span>
    <span style="color: #008000">//----------------------------------------------------------------------------------------------------</span>

    client.Execute(<span style="color: #a31515">&quot;delete from Stocks&quot;</span>)
    checkError(client, <span style="color: #a31515">&quot;delete failed&quot;</span>)

    <span style="color: #008000">//----------------------------------------------------------------------------------------------------</span>
    <span style="color: #008000">// PROCESS ALL PUBLISHED</span>
    <span style="color: #008000">//----------------------------------------------------------------------------------------------------</span>

    <span style="color: #0000ff">for</span> subscriber.WaitForPubSub(timeout) {
        fmt.Println(<span style="color: #a31515">&quot;*********************************&quot;</span>)
        fmt.Println(<span style="color: #a31515">&quot;Action:&quot;</span>, subscriber.Action())
        <span style="color: #0000ff">for</span> subscriber.NextRow() {
            <span style="color: #0000ff">for</span> ordinal, column := <span style="color: #0000ff">range</span> subscriber.Columns() {
                fmt.Printf(<span style="color: #a31515">&quot;%s:%s &quot;</span>, column, subscriber.ValueByOrdinal(ordinal))
            }
            fmt.Println(<span style="color: #a31515">&quot;&quot;</span>)
        }
        checkError(subscriber, <span style="color: #a31515">&quot;NextRow failed&quot;</span>)
    }
    checkError(subscriber, <span style="color: #a31515">&quot;WaitForPubSub failed&quot;</span>)

    <span style="color: #008000">//----------------------------------------------------------------------------------------------------</span>
    <span style="color: #008000">// UNSUBSCRIBE</span>
    <span style="color: #008000">//----------------------------------------------------------------------------------------------------</span>

    subscriber.Execute(<span style="color: #a31515">&quot;unsubscribe from Stocks&quot;</span>)
    checkError(subscriber, <span style="color: #a31515">&quot;NextRow failed&quot;</span>)

    <span style="color: #008000">//----------------------------------------------------------------------------------------------------</span>
    <span style="color: #008000">// DISCONNECT</span>
    <span style="color: #008000">//----------------------------------------------------------------------------------------------------</span>

    client.Disconnect()
    subscriber.Disconnect()
}
</pre></div>


   </div>

	</div>
			
		<br clear="all" />
	<div id="license-text">The content of this page is licensed under the Creative Commons Attribution 3.0 License. Portions of this page are modifications from work created and <a
  href="http://code.google.com/policies.html">shared by Google</a>
  and used according to terms described in the <a
  href="http://creativecommons.org/licenses/by/3.0/">Creative Commons
  3.0 Attribution License</a>. Please find the original work at <a href="http://www.golang.org">golang.org</a></div>		
</div>
</div>
	
</body>

</html>
